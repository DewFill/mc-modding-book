<!DOCTYPE html>
<html>
<head>

<title>Конфигурация - Minecraft Modding</title>

<meta charset="UTF-8">

<link rel="icon" href="http://mcmodding.ru/favicon_standart.png">

<meta name="description" content="Конфигурация нашего плагина">

<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Google Material Icons -->
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

<meta property="og:title"       content="Конфигурация - Minecraft Modding">
<meta property="og:description" content="Конфигурация нашего плагина">
<meta property="og:type"        content="article">
<meta property="og:url"         content="http://mcmodding.ru/book/1.11+/bukkit/base/config">
<meta property="og:image"       content="http://mcmodding.ru/favicon_standart.png">
<!-- jQuery -->
<script src="http://mcmodding.ru/libs/jQuery/jquery-3.2.0.min.js"></script>

<!-- Hammer.js -->
<script src="http://mcmodding.ru/libs/hammer/hammer.min.js"></script>

<!-- Include scrollbar width in site width -->
<script src="http://mcmodding.ru/libs/mq.genie/mq.genie.min.js"></script>

<!-- highlight.js -->
<link href="http://mcmodding.ru/libs/highlight/styles/idea.css" rel="stylesheet">
<style>
    pre code.hljs {
        display: block;
    }

    code.hljs {
        display: inline;
    }
</style>
<script src="http://mcmodding.ru/libs/highlight/highlight.pack.js"></script>
<script>
    $(() => {
        $('pre code').each( (i, element) => {
            hljs.highlightBlock(element);
        });
    });
</script>

<!-- Magnific Popup -->
<link rel="stylesheet" href="http://mcmodding.ru/libs/magnific-popup/magnific-popup.min.css">
<script src="http://mcmodding.ru/libs/magnific-popup/magnific-popup.min.js"></script>
<script>
    $(() => {
        $('article .inner').magnificPopup({
            delegate: 'img',
            type: 'image',
            callbacks: {
                elementParse: (item) => { item.src = item.el.attr('src'); }
            }
        });
    });
</script>

<!-- Snap.svg -->
<script src="http://mcmodding.ru/libs/snap.svg/snap.svg-min.js"></script>
<!-- Global CSS -->
<link href="http://mcmodding.ru/g-styles/global.min.css" rel="stylesheet">

<!-- Book CSS -->
<link href="http://mcmodding.ru/book/styles/book.min.css" rel="stylesheet">

<!-- Book JS -->
<script>
    let book_id = '1.11+-bukkit';
</script>
<script src="http://mcmodding.ru/book/scripts/book.min.js"></script>
</head>
<body>

<header>
    <div class="inner">

        <div class="site-menu show-book-nav">
            <div title="Оглавление учебника" class="menu-item">
                <i class="material-icons">menu</i>
            </div>
        </div>

        <div id="logotype">
            <div class="cube">
                    <img src="http://mcmodding.ru/logotype/classic/front.png" class="side front">
                    <img src="http://mcmodding.ru/logotype/classic/back.png" class="side back">
                    <img src="http://mcmodding.ru/logotype/classic/left.png" class="side left">
                    <img src="http://mcmodding.ru/logotype/classic/right.png" class="side right">
                    <img src="http://mcmodding.ru/logotype/classic/top.png" class="side top">
                    <img src="http://mcmodding.ru/logotype/classic/bottom.png" class="side bottom">
            </div>
        </div>

        <div class="site-info">
            <div class="title">Minecraft Modding</div>
            <div class="description">Учебник по созданию Minecraft модов</div>
        </div>

        <div class="site-menu show-menu">
            <div class="menu-item">
                <i title="Меню сайта" class="material-icons">more_horiz</i>
            </div>
        </div>

        <div class="site-menu transformable">

            <a href="http://mcmodding.ru" title="Главная" class="menu-item">
                <i class="material-icons">home</i><span>Главная</span>
            </a>

            <a href="http://mcmodding.ru/book/1.11+/bukkit/prep/install" title="Учебник" class="menu-item">
                <i class="material-icons">import_contacts</i><span>Учебник</span>
            </a>

            <a href="http://forum.mcmodding.ru/newthread.php?fid=23" target="_blank" title="Спросить" class="menu-item">
                <i class="material-icons">help_outline</i><span>Спросить</span>
            </a>

            <a href="http://forum.mcmodding.ru" target="_blank" title="Форум" class="menu-item">
                <i class="material-icons">forum</i><span>Форум</span>
            </a>

        </div>

    </div>
</header>
<nav>

    <div class="inner">

        <section class="book-choose">


                <div class="version-choose">
                    <label>Версия:
                        <select onChange="window.location.href=this.value">

                                <optgroup label="Релиз">
                                        <option value="http://mcmodding.ru/book/1.12+/forge/prep/install" >1.12+</option>
                                        <option value="http://mcmodding.ru/book/1.11+/forge/prep/install" selected>1.11+</option>
                                        <option value="http://mcmodding.ru/book/1.7.10/forge/base/first_steps" >1.7.10</option>
                                </optgroup>



                        </select>
                    </label>
                </div>


            <div class="api-choose">
                <label>API:
                    <select onChange="window.location.href=this.value">
                            <option value="http://mcmodding.ru/book/1.11+/bukkit/prep/install" selected>Bukkit</option>
                            <option value="http://mcmodding.ru/book/1.11+/bungeecord/prep/install" >BungeeCord</option>
                            <option value="http://mcmodding.ru/book/1.11+/forge/prep/install" >Forge</option>
                    </select>
                </label>
            </div>

        </section>

        <div class="categories">
                <div class="category">

                    <div class="category-header">
                        <a href="http://mcmodding.ru/book/1.11+/bukkit/prep/install" class="category-article ">Подготовка</a>

                        <svg xmlns="http://www.w3.org/2000/svg" title="Раскрыть/скрыть категорию" class="visibility-switcher switcher-0 closed" width="16" height="16" viewBox="0 0 512 512">
                            <rect class="horizontal-rect" x="0" y="192" width="512" height="128" rx="15" ry="15"/>
                            <rect class="vertical-rect"   x="192" y="0" width="128" height="512" rx="15" ry="15"/>
                        </svg>
                    </div>

                    <div class="category-articles">
                    </div>

                </div>
                <hr>
                <div class="category">

                    <div class="category-header">
                        <a href="http://mcmodding.ru/book/1.11+/bukkit/base/main" class="category-article selected">Основное</a>

                        <svg xmlns="http://www.w3.org/2000/svg" title="Раскрыть/скрыть категорию" class="visibility-switcher switcher-1 closed" width="16" height="16" viewBox="0 0 512 512">
                            <rect class="horizontal-rect" x="0" y="192" width="512" height="128" rx="15" ry="15"/>
                            <rect class="vertical-rect"   x="192" y="0" width="128" height="512" rx="15" ry="15"/>
                        </svg>
                    </div>

                    <div class="category-articles">
                            <a href="http://mcmodding.ru/book/1.11+/bukkit/base/main" class="article ">Главный класс</a>
                            <a href="http://mcmodding.ru/book/1.11+/bukkit/base/events" class="article ">События</a>
                            <a href="http://mcmodding.ru/book/1.11+/bukkit/base/commands" class="article ">Команды</a>
                            <a href="http://mcmodding.ru/book/1.11+/bukkit/base/config" class="article selected">Конфигурация</a>
                            <a href="http://mcmodding.ru/book/1.11+/bukkit/base/permissions" class="article ">Использование прав</a>
                            <a href="http://mcmodding.ru/book/1.11+/bukkit/base/debug" class="article ">Отладка плагина</a>
                            <a href="http://mcmodding.ru/book/1.11+/bukkit/base/bundle" class="article ">Связка с BungeeCord</a>
                            <a href="http://mcmodding.ru/book/1.11+/bukkit/base/scoreboard" class="article ">Scoreboard</a>
                            <a href="http://mcmodding.ru/book/1.11+/bukkit/base/packets" class="article ">Пакеты</a>
                            <a href="http://mcmodding.ru/book/1.11+/bukkit/base/database" class="article ">База данных</a>
                            <a href="http://mcmodding.ru/book/1.11+/bukkit/base/export" class="article ">Экспорт</a>
                    </div>

                </div>
                <hr>
        </div>

        <section class="ad-after-nav">

            <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
            <!-- MCModding Book - Реклама под навигацией -->
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-8094912170389944"
                 data-ad-slot="5398483104"
                 data-ad-format="auto"></ins>
            <script>
                (adsbygoogle = window.adsbygoogle || []).push({});
            </script>

        </section>

    </div>

</nav><article>

    <div class="inner">

        <a href="https://github.com/mc-modding/mc-modding-book/blob/master/book/1.11+/bukkit/base/config/article.md" target="_blank" class="edit-article"><i class="material-icons">mode_edit</i><span>Редактировать</span></a>

        <h2 id="конфигурация---простой-вариант">Конфигурация - Простой вариант<a title="Ссылка на этот раздел" href="#конфигурация---простой-вариант"><i class="material-icons">link</i></a></h2>
<p>В конфигурации мы будем хранить данные доступные для обычных админов, которые не сильны в программировании, да и для более гибкой настройки самого плагина.</p>
<p>Для начала добавим в главном классе, в метод <code>onEnable</code> такой код:</p>
<pre><code class="Java language-Java">//Данный метод копирует данные из файла
getConfig().options().copyDefaults(true);
//Данный метод сохраняет данные конфигурации.
saveConfig();
</code></pre>
<p>В папке resources создадим файл <code>config.yml</code>(Только такое название!) и добавим туда такие данные:</p>
<pre><code class="YAML language-YAML">boolean_param: true
int_param: 25
string_param: 'This is text!'
section:
  param_1: 'Param 1'
  param_2: 2
  section_2:
    param_1: 'Section 2 -&gt; param 1'
    param_2: false
array_param:
- 'Hello, my friend!'
- 'My name TuTPlugin'
</code></pre>
<p>А сейчас мы попробуем использовать данные из конфигурации. Пример использования:</p>
<pre><code class="Java language-Java">    @EventHandler
    public void onJoin(PlayerJoinEvent e)
    {
        //Получаем из конфигурации секцию
        ConfigurationSection section = TuTPlugin.getInstance().getConfig().getConfigurationSection("section");
        //Получаем из конфигурации секцию второго уровня. Уровней может быть много, но это уже на Ваше усмотрение.
        ConfigurationSection section_two_level = section.getConfigurationSection("section_2");

        //Игрок отправит сообщение с текстом из секции первого уровня из параметра 1
        e.getPlayer().sendMessage(section.getString("param_1"));
        //Игрок отправит сообщение с текстом из секции второго уровня из параметра 1
        e.getPlayer().sendMessage(String.valueOf(section_two_level.getBoolean("param_1")));
    }

    @EventHandler
    public void onBreak(BlockBreakEvent e)
    {
        Player player = e.getPlayer();
        //Получаем логическое значение из boolean_param.
        boolean isCanceled = TuTPlugin.getInstance().getConfig().getBoolean("boolean_param");

        if(e.getBlock().getType() == Material.DIRT)
        {
            //Если параметр isCanceled вернёт true, то событие будет отменено.
            e.setCancelled(isCanceled);
            player.sendMessage("Блок запривачен!");
        }
    }
</code></pre>
<h2 id="конфигурация---продвинутый-вариант">Конфигурация - Продвинутый вариант<a title="Ссылка на этот раздел" href="#конфигурация---продвинутый-вариант"><i class="material-icons">link</i></a></h2>
<p>Для начала создадим класс ConfigManager.</p>
<pre><code class="Java language-Java">public class ConfigManager
{
    private TuTPlugin core;
    private File configFile;
    private FileConfiguration configuration;

    public ConfigManager(TuTPlugin core)
    {
        this.core = core;
        loadConfiguration();
    }

    public FileConfiguration getConfiguration()
    {
        return this.configuration;
    }

    public void loadConfiguration()
    {
        configFile = new File(new File(this.core.getDataFolder(), "/config"), "configuration.yml");
        configuration = YamlConfiguration.loadConfiguration(checkpointFile);
    }

    public void saveConfig()
    {
        if(this.configuration == null || this.configFile == null) return;

        try {
            this.configuration.save(configFile);
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
</code></pre>
<p>Конструктор будет загружать наш конфиг во время инициализации. Метод <code>loadConfiguration</code> будет загружать нашу конфигурацию, <code>saveConfig</code> будет сохранять нашу конфигурацию, а функция <code>getConfiguration</code> будет получать конфигурацию. Перейдём в главный класс плагина и пропишем туда переменную</p>
<pre><code class="Java language-Java">private ConfigManager configManager;
</code></pre>
<p>в метод <code>onEnable</code> такой код:</p>
<pre><code class="Java language-Java">//Инициализируем ConfigManger, чтобы он мог загрузить наш конфиг.
configManager = new ConfigManager(this);
//Сохраняем конфиг
configManager.saveConfig();
</code></pre>
<p>в метод <code>onDisable</code> такой код:</p>
<pre><code class="Java language-Java">configManager.saveConfig();
</code></pre>
<p>С настройкой закончено! А сейчас давайте создадим папку в <code>resources</code> под названием <code>config</code> и в ней файл <code>configuration</code>, и пропишем в него такие данные:</p>
<pre><code class="YAML language-YAML">//Это логическое поле
boolean_param: true

//Это цело-численно поле
int_param: 25

//Это текстовое поле
string_param: 'This is text!'

section:
  param_1: 'Param 1'
  param_2: 2
  section_2:
    param_1: 'Section 2 -&gt; param 1'
    param_2: false

//Теперь мы может оставлять комментарии и ничего с ними не случится.
array_param:
- 'Hello, my friend!'
- 'My name TuTPlugin'
</code></pre>
<p>Но как же теперь нам использовать нашу конфигурацию? Очень просто, так же как в прошлой статье, но только с небольшими изменениями. Выбираем нужный нам класс и создаём там переменную:</p>
<pre><code class="Java language-Java">private ConfigManager configManager;
</code></pre>
<p>и в конструкторе добавляем параметр <code>ConfigManager manager</code> и прописываем такой код:</p>
<pre><code class="Java language-Java">this.manager = manager;
</code></pre>
<p>Осталось дело за малым! В любом нужном нам месте этого класса прописываем:</p>
<pre><code class="Java language-Java">this.manager.getConfiguration()
</code></pre>
<p>И теперь нам достаточно сделать всё так же как и с <code>getConfig</code> в предыдущей статье.
P.s. Да, данный способ не очень хорош и довольно сложен, но таким способом вы сможете создать больше файлов для конфигурации, хранения информации и т.д. А так же все комментарии будут сохранятся и с конфигом ничего особо криминального не произойдёт, как это может случится с конфигом из первой статьи.</p>

    </div>

    <section class="next-previous-articles">

        <a class="previous-article" title="Переход на предыдущую статью" href="http:&#x2F;&#x2F;mcmodding.ru&#x2F;book&#x2F;1.11+&#x2F;bukkit&#x2F;base&#x2F;commands">
            <svg xmlns="http://www.w3.org/2000/svg" width="32" heigth="32" viewBox="0 0 512 512" class="previous-icon">
                <path d="M16 256l240 240v-144h256v-192h-256v-144z"></path>
            </svg>
            <span class="label">Предыдущая статья</span>
        </a>

        <div class="sep"></div>

        <a class="next-article" title="Переход на следующую статью" href="http:&#x2F;&#x2F;mcmodding.ru&#x2F;book&#x2F;1.11+&#x2F;bukkit&#x2F;base&#x2F;permissions">
            <span class="label">Следующая статья</span>
            <svg xmlns="http://www.w3.org/2000/svg" width="32" heigth="32" viewBox="0 0 512 512" class="next-icon">
                <path d="M496 256l-240-240v144h-256v192h256v144z"></path>
            </svg>
        </a>

    </section>

    <section class="contributors">


            <a href="https://github.com/Ivasik78" target="_blank" title="К профилю GitHub" class="contributor">

                <img class="avatar" src="https://github.com/Ivasik78.png?size=40">

                <div class="info">

                    <div class="name">Ivasik</div>

                    <div class="role">Автор</div>

                </div>

            </a>


    </section>

    <section class="ad-after-article">

        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <!-- McModding Book Под статьей -->
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-client="ca-pub-8094912170389944"
             data-ad-slot="4828749197"
             data-ad-format="auto"></ins>
        <script>
            (adsbygoogle = window.adsbygoogle || []).push({});
        </script>

    </section>

    <section class="disqus">

        <div id="disqus_thread"></div>
        <script>

            var disqus_config = function () {
                this.page.identifier = 'http://mcmodding.ru/book/1.11+/bukkit/base/config';
            };

            (function() { // DON'T EDIT BELOW THIS LINE
                var d = document, s = d.createElement('script');
                s.src = 'https://mcmodding.disqus.com/embed.js';
                s.setAttribute('data-timestamp', +new Date());
                (d.head || d.body).appendChild(s);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

    </section>

    <div class="site-info">

        <a href="https://github.com/mc-modding/mc-modding-book/commits/master" target="_blank" class="copyright">mcmodding.ru</a>

        <a class="version-link" title="Последние изменения" href="https://github.com/mc-modding/mc-modding-book/commits/master" target="_blank">v1.1.1</a>

    </div>

</article>
<!-- Yandex.Metrika counter -->
<script type="text/javascript">
    (function (d, w, c) {
        (w[c] = w[c] || []).push(function() {
            try {
                w.yaCounter21621697 = new Ya.Metrika({
                    id:21621697,
                    clickmap:true,
                    trackLinks:true,
                    accurateTrackBounce:true,
                    webvisor:true
                });
            } catch(e) { }
        });

        var n = d.getElementsByTagName("script")[0],
                s = d.createElement("script"),
                f = function () { n.parentNode.insertBefore(s, n); };
        s.type = "text/javascript";
        s.async = true;
        s.src = "https://mc.yandex.ru/metrika/watch.js";

        if (w.opera == "[object Opera]") {
            d.addEventListener("DOMContentLoaded", f, false);
        } else { f(); }
    })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/21621697" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->

<!-- Google Analytics -->
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-42024721-1', 'auto');
    ga('send', 'pageview');

</script>
<!-- /Google Analytics -->
</body>
</html>