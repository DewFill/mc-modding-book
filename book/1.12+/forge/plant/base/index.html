<!DOCTYPE html>
<html>
<head>

<title>Агрокультуры - Minecraft Modding</title>

<meta charset="UTF-8">

<link rel="icon" href="http://mcmodding.ru/favicon_standart.png">

<meta name="description" content="В этой статье речь пойдёт о создании собственных агрокультур. Будут рассмотрены примеры создания блока культуры, семян для выращивания и урожая - предмета, который будет выпадать с растения.">

<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Google Auto-Ads -->
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
    (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8094912170389944",
        enable_page_level_ads: true
    });
</script>

<!-- Google Material Icons -->
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

<meta property="og:title"       content="Агрокультуры - Minecraft Modding">
<meta property="og:description" content="В этой статье речь пойдёт о создании собственных агрокультур. Будут рассмотрены примеры создания блока культуры, семян для выращивания и урожая - предмета, который будет выпадать с растения.">
<meta property="og:type"        content="article">
<meta property="og:url"         content="http://mcmodding.ru/book/1.12+/forge/plant/base">
<meta property="og:image"       content="http://mcmodding.ru/favicon_standart.png">
<!-- jQuery -->
<script src="http://mcmodding.ru/libs/jQuery/jquery-3.2.0.min.js"></script>

<!-- Hammer.js -->
<script src="http://mcmodding.ru/libs/hammer/hammer.min.js"></script>

<!-- Include scrollbar width in site width -->
<script src="http://mcmodding.ru/libs/mq.genie/mq.genie.min.js"></script>

<!-- highlight.js -->
<link href="http://mcmodding.ru/libs/highlight/styles/idea.css" rel="stylesheet">
<style>
    pre code.hljs {
        display: block;
    }

    code.hljs {
        display: inline;
    }
</style>
<script src="http://mcmodding.ru/libs/highlight/highlight.pack.js"></script>
<script>
    $(() => {
        $('pre code').each( (i, element) => {
            hljs.highlightBlock(element);
        });
    });
</script>

<!-- Magnific Popup -->
<link rel="stylesheet" href="http://mcmodding.ru/libs/magnific-popup/magnific-popup.min.css">
<script src="http://mcmodding.ru/libs/magnific-popup/magnific-popup.min.js"></script>
<script>
    $(() => {
        $('article .inner').magnificPopup({
            delegate: 'img',
            type: 'image',
            callbacks: {
                elementParse: (item) => { item.src = item.el.attr('src'); }
            }
        });
    });
</script>

<!-- Snap.svg -->
<script src="http://mcmodding.ru/libs/snap.svg/snap.svg-min.js"></script>
<!-- Global CSS -->
<link href="http://mcmodding.ru/g-styles/global.min.css" rel="stylesheet">

<!-- Book CSS -->
<link href="http://mcmodding.ru/book/styles/book.min.css" rel="stylesheet">

<!-- Book JS -->
<script>
    let book_id = '1.12+-forge';
</script>
<script src="http://mcmodding.ru/book/scripts/book.min.js"></script>
</head>
<body>

<header>
    <div class="inner">

        <div class="site-menu show-book-nav">
            <div title="Оглавление учебника" class="menu-item">
                <i class="material-icons">menu</i>
            </div>
        </div>

        <div id="logotype">
            <div class="cube">
                    <img src="http://mcmodding.ru/logotype/piston/front.png" class="side front">
                    <img src="http://mcmodding.ru/logotype/piston/back.png" class="side back">
                    <img src="http://mcmodding.ru/logotype/piston/left.png" class="side left">
                    <img src="http://mcmodding.ru/logotype/piston/right.png" class="side right">
                    <img src="http://mcmodding.ru/logotype/piston/top.png" class="side top">
                    <img src="http://mcmodding.ru/logotype/piston/bottom.png" class="side bottom">
            </div>
        </div>

        <div class="site-info">
            <div class="title">Minecraft Modding</div>
            <div class="description">Учебник по созданию Minecraft модов</div>
        </div>

        <div class="site-menu show-menu">
            <div class="menu-item">
                <i title="Меню сайта" class="material-icons">more_horiz</i>
            </div>
        </div>

        <div class="site-menu transformable">

            <a href="http://mcmodding.ru" title="Главная" class="menu-item">
                <i class="material-icons">home</i><span>Главная</span>
            </a>

            <a href="http://mcmodding.ru/book/1.12+/forge/prep/install" title="Учебник" class="menu-item">
                <i class="material-icons">import_contacts</i><span>Учебник</span>
            </a>

            <a href="https://forum.mcmodding.ru/forums/%D0%92%D0%BE%D0%BF%D1%80%D0%BE%D1%81%D1%8B.23/" target="_blank" title="Спросить" class="menu-item">
                <i class="material-icons">help_outline</i><span>Спросить</span>
            </a>

            <a href="https://forum.mcmodding.ru" target="_blank" title="Форум" class="menu-item">
                <i class="material-icons">forum</i><span>Форум</span>
            </a>

        </div>

    </div>
</header>
<nav>

    <div class="inner">

        <section class="book-choose">


                <div class="version-choose">
                    <label>Версия:
                        <select onChange="window.location.href=this.value">

                                <optgroup label="Релиз">
                                        <option value="http://mcmodding.ru/book/1.12+/forge/prep/install" selected>1.12+</option>
                                        <option value="http://mcmodding.ru/book/1.11+/forge/prep/install" >1.11+</option>
                                        <option value="http://mcmodding.ru/book/1.7.10/forge/base/first_steps" >1.7.10</option>
                                </optgroup>



                        </select>
                    </label>
                </div>


            <div class="api-choose">
                <label>API:
                    <select onChange="window.location.href=this.value">
                            <option value="http://mcmodding.ru/book/1.12+/forge/prep/install" selected>Forge</option>
                    </select>
                </label>
            </div>

        </section>

        <div class="categories">
                <div class="category">

                    <div class="category-header">
                        <a href="http://mcmodding.ru/book/1.12+/forge/prep/install" class="category-article ">Подготовка</a>

                        <svg xmlns="http://www.w3.org/2000/svg" title="Раскрыть/скрыть категорию" class="visibility-switcher switcher-0 closed" width="16" height="16" viewBox="0 0 512 512">
                            <rect class="horizontal-rect" x="0" y="192" width="512" height="128" rx="15" ry="15"/>
                            <rect class="vertical-rect"   x="192" y="0" width="128" height="512" rx="15" ry="15"/>
                        </svg>
                    </div>

                    <div class="category-articles">
                            <a href="http://mcmodding.ru/book/1.12+/forge/prep/install" class="article ">Установка программ</a>
                            <a href="http://mcmodding.ru/book/1.12+/forge/prep/setup_idea" class="article ">Использование Idea</a>
                            <a href="http://mcmodding.ru/book/1.12+/forge/prep/setup_eclipse" class="article ">Использование Eclipse</a>
                            <a href="http://mcmodding.ru/book/1.12+/forge/prep/off_skin" class="article ">Собственный скин</a>
                            <a href="http://mcmodding.ru/book/1.12+/forge/prep/problems" class="article ">Решение проблем</a>
                    </div>

                </div>
                <hr>
                <div class="category">

                    <div class="category-header">
                        <a href="http://mcmodding.ru/book/1.12+/forge/base/mod_structure" class="category-article ">Основы Forge</a>

                        <svg xmlns="http://www.w3.org/2000/svg" title="Раскрыть/скрыть категорию" class="visibility-switcher switcher-1 closed" width="16" height="16" viewBox="0 0 512 512">
                            <rect class="horizontal-rect" x="0" y="192" width="512" height="128" rx="15" ry="15"/>
                            <rect class="vertical-rect"   x="192" y="0" width="128" height="512" rx="15" ry="15"/>
                        </svg>
                    </div>

                    <div class="category-articles">
                            <a href="http://mcmodding.ru/book/1.12+/forge/base/mod_structure" class="article ">Структура мода</a>
                            <a href="http://mcmodding.ru/book/1.12+/forge/base/mod_annotation" class="article ">Аннотация @Mod</a>
                            <a href="http://mcmodding.ru/book/1.12+/forge/base/loading_stages" class="article ">Стадии загрузки мода</a>
                            <a href="http://mcmodding.ru/book/1.12+/forge/base/proxy" class="article ">Прокси</a>
                            <a href="http://mcmodding.ru/book/1.12+/forge/base/build_mod" class="article ">Сборка мода</a>
                    </div>

                </div>
                <hr>
                <div class="category">

                    <div class="category-header">
                        <a href="http://mcmodding.ru/book/1.12+/forge/item/base" class="category-article ">Предметы</a>

                        <svg xmlns="http://www.w3.org/2000/svg" title="Раскрыть/скрыть категорию" class="visibility-switcher switcher-2 closed" width="16" height="16" viewBox="0 0 512 512">
                            <rect class="horizontal-rect" x="0" y="192" width="512" height="128" rx="15" ry="15"/>
                            <rect class="vertical-rect"   x="192" y="0" width="128" height="512" rx="15" ry="15"/>
                        </svg>
                    </div>

                    <div class="category-articles">
                            <a href="http://mcmodding.ru/book/1.12+/forge/item/base" class="article ">Создание предмета</a>
                            <a href="http://mcmodding.ru/book/1.12+/forge/item/food" class="article ">Еда</a>
                            <a href="http://mcmodding.ru/book/1.12+/forge/item/tools" class="article ">Инструменты и меч</a>
                            <a href="http://mcmodding.ru/book/1.12+/forge/item/repair" class="article ">Починка инструментов</a>
                            <a href="http://mcmodding.ru/book/1.12+/forge/item/armor" class="article ">Броня</a>
                            <a href="http://mcmodding.ru/book/1.12+/forge/item/metadata" class="article ">Метадата</a>
                            <a href="http://mcmodding.ru/book/1.12+/forge/item/nbt" class="article ">Хранение в предмете</a>
                            <a href="http://mcmodding.ru/book/1.12+/forge/item/loot" class="article ">Система лута</a>
                            <a href="http://mcmodding.ru/book/1.12+/forge/item/rarity" class="article ">Редкость предметов</a>
                            <a href="http://mcmodding.ru/book/1.12+/forge/item/burn" class="article ">Предмет с временем горения</a>
                    </div>

                </div>
                <hr>
                <div class="category">

                    <div class="category-header">
                        <a href="http://mcmodding.ru/book/1.12+/forge/block/base" class="category-article ">Блоки</a>

                        <svg xmlns="http://www.w3.org/2000/svg" title="Раскрыть/скрыть категорию" class="visibility-switcher switcher-3 closed" width="16" height="16" viewBox="0 0 512 512">
                            <rect class="horizontal-rect" x="0" y="192" width="512" height="128" rx="15" ry="15"/>
                            <rect class="vertical-rect"   x="192" y="0" width="128" height="512" rx="15" ry="15"/>
                        </svg>
                    </div>

                    <div class="category-articles">
                    </div>

                </div>
                <hr>
                <div class="category">

                    <div class="category-header">
                        <a href="http://mcmodding.ru/book/1.12+/forge/creativetab/base" class="category-article ">Вкладка в креативе</a>

                        <svg xmlns="http://www.w3.org/2000/svg" title="Раскрыть/скрыть категорию" class="visibility-switcher switcher-4 closed" width="16" height="16" viewBox="0 0 512 512">
                            <rect class="horizontal-rect" x="0" y="192" width="512" height="128" rx="15" ry="15"/>
                            <rect class="vertical-rect"   x="192" y="0" width="128" height="512" rx="15" ry="15"/>
                        </svg>
                    </div>

                    <div class="category-articles">
                    </div>

                </div>
                <hr>
                <div class="category">

                    <div class="category-header">
                        <a href="http://mcmodding.ru/book/1.12+/forge/lang/base" class="category-article ">Локализация</a>

                        <svg xmlns="http://www.w3.org/2000/svg" title="Раскрыть/скрыть категорию" class="visibility-switcher switcher-5 closed" width="16" height="16" viewBox="0 0 512 512">
                            <rect class="horizontal-rect" x="0" y="192" width="512" height="128" rx="15" ry="15"/>
                            <rect class="vertical-rect"   x="192" y="0" width="128" height="512" rx="15" ry="15"/>
                        </svg>
                    </div>

                    <div class="category-articles">
                    </div>

                </div>
                <hr>
                <div class="category">

                    <div class="category-header">
                        <a href="http://mcmodding.ru/book/1.12+/forge/events/base" class="category-article ">События</a>

                        <svg xmlns="http://www.w3.org/2000/svg" title="Раскрыть/скрыть категорию" class="visibility-switcher switcher-6 closed" width="16" height="16" viewBox="0 0 512 512">
                            <rect class="horizontal-rect" x="0" y="192" width="512" height="128" rx="15" ry="15"/>
                            <rect class="vertical-rect"   x="192" y="0" width="128" height="512" rx="15" ry="15"/>
                        </svg>
                    </div>

                    <div class="category-articles">
                            <a href="http://mcmodding.ru/book/1.12+/forge/events/base" class="article ">Использование событий</a>
                            <a href="http://mcmodding.ru/book/1.12+/forge/events/table" class="article ">Таблица событий</a>
                    </div>

                </div>
                <hr>
                <div class="category">

                    <div class="category-header">
                        <a href="http://mcmodding.ru/book/1.12+/forge/craftsmeltingandbrewing/craft" class="category-article ">Рецепты</a>

                        <svg xmlns="http://www.w3.org/2000/svg" title="Раскрыть/скрыть категорию" class="visibility-switcher switcher-7 closed" width="16" height="16" viewBox="0 0 512 512">
                            <rect class="horizontal-rect" x="0" y="192" width="512" height="128" rx="15" ry="15"/>
                            <rect class="vertical-rect"   x="192" y="0" width="128" height="512" rx="15" ry="15"/>
                        </svg>
                    </div>

                    <div class="category-articles">
                    </div>

                </div>
                <hr>
                <div class="category">

                    <div class="category-header">
                        <a href="http://mcmodding.ru/book/1.12+/forge/achievements/prep" class="category-article ">Достижения</a>

                        <svg xmlns="http://www.w3.org/2000/svg" title="Раскрыть/скрыть категорию" class="visibility-switcher switcher-8 closed" width="16" height="16" viewBox="0 0 512 512">
                            <rect class="horizontal-rect" x="0" y="192" width="512" height="128" rx="15" ry="15"/>
                            <rect class="vertical-rect"   x="192" y="0" width="128" height="512" rx="15" ry="15"/>
                        </svg>
                    </div>

                    <div class="category-articles">
                            <a href="http://mcmodding.ru/book/1.12+/forge/achievements/prep" class="article ">Начало</a>
                            <a href="http://mcmodding.ru/book/1.12+/forge/achievements/base" class="article ">Создание достижения</a>
                            <a href="http://mcmodding.ru/book/1.12+/forge/achievements/recipes" class="article ">Получение рецептов</a>
                    </div>

                </div>
                <hr>
                <div class="category">

                    <div class="category-header">
                        <a href="http://mcmodding.ru/book/1.12+/forge/plant/base" class="category-article selected">Растения</a>

                        <svg xmlns="http://www.w3.org/2000/svg" title="Раскрыть/скрыть категорию" class="visibility-switcher switcher-9 closed" width="16" height="16" viewBox="0 0 512 512">
                            <rect class="horizontal-rect" x="0" y="192" width="512" height="128" rx="15" ry="15"/>
                            <rect class="vertical-rect"   x="192" y="0" width="128" height="512" rx="15" ry="15"/>
                        </svg>
                    </div>

                    <div class="category-articles">
                    </div>

                </div>
                <hr>
                <div class="category">

                    <div class="category-header">
                        <a href="http://mcmodding.ru/book/1.12+/forge/advanced/layers" class="category-article ">Продвинутые статьи</a>

                        <svg xmlns="http://www.w3.org/2000/svg" title="Раскрыть/скрыть категорию" class="visibility-switcher switcher-10 closed" width="16" height="16" viewBox="0 0 512 512">
                            <rect class="horizontal-rect" x="0" y="192" width="512" height="128" rx="15" ry="15"/>
                            <rect class="vertical-rect"   x="192" y="0" width="128" height="512" rx="15" ry="15"/>
                        </svg>
                    </div>

                    <div class="category-articles">
                            <a href="http://mcmodding.ru/book/1.12+/forge/advanced/layers" class="article ">Слои</a>
                            <a href="http://mcmodding.ru/book/1.12+/forge/advanced/keybinds" class="article ">Привязка клавиш</a>
                            <a href="http://mcmodding.ru/book/1.12+/forge/advanced/buffs" class="article ">Система временных эффектов</a>
                            <a href="http://mcmodding.ru/book/1.12+/forge/advanced/sounds" class="article ">Звуки</a>
                    </div>

                </div>
                <hr>
                <div class="category">

                    <div class="category-header">
                        <a href="http://mcmodding.ru/book/1.12+/forge/other/sources" class="category-article ">Дополнительно</a>

                        <svg xmlns="http://www.w3.org/2000/svg" title="Раскрыть/скрыть категорию" class="visibility-switcher switcher-11 closed" width="16" height="16" viewBox="0 0 512 512">
                            <rect class="horizontal-rect" x="0" y="192" width="512" height="128" rx="15" ry="15"/>
                            <rect class="vertical-rect"   x="192" y="0" width="128" height="512" rx="15" ry="15"/>
                        </svg>
                    </div>

                    <div class="category-articles">
                            <a href="http://mcmodding.ru/book/1.12+/forge/other/sources" class="article ">Исходники Minecraft</a>
                            <a href="http://mcmodding.ru/book/1.12+/forge/other/jei_integration" class="article ">Интеграция с Just Enough Items</a>
                            <a href="http://mcmodding.ru/book/1.12+/forge/other/access_transformers" class="article ">Access Transformers</a>
                    </div>

                </div>
                <hr>
        </div>

        <section class="ad-after-nav">

            <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
            <!-- MCModding Book - Реклама под навигацией -->
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-8094912170389944"
                 data-ad-slot="5398483104"
                 data-ad-format="auto"></ins>
            <script>
                (adsbygoogle = window.adsbygoogle || []).push({});
            </script>

        </section>

    </div>

</nav><article>

    <div class="inner">

        <a href="https://github.com/mc-modding/mc-modding-book/blob/master/book/1.12+/forge/plant/base/article.md" target="_blank" class="edit-article"><i class="material-icons">mode_edit</i><span>Редактировать</span></a>

        <h1 id="агрокультуры">Агрокультуры<a title="Ссылка на этот раздел" href="#агрокультуры"><i class="material-icons">link</i></a></h1>
<p><em>Гайд перевел и дополнил пользователь форума — <a href="https://forum.mcmodding.ru/members/austeretony.7279/" target="_blank">AustereTony</a>.</em></p>
<p>Приветствую. В этой статье речь пойдёт о создании собственных агрокультур. Будут рассмотрены примеры создания блока культуры, семян для выращивания и урожая - предмета, который будет выпадать с растения.</p>
<p>Я позволил внести себе некоторые правки в перевод и добавить дополнительной информации. Исходники доступны <a href="https://github.com/AustereTony/Guides/tree/master/1.12.2/Crops" target="_blank">здесь</a>. Приятного чтения.</p>
<p>Для большей ясности данный туториал будет разделён на три основные части:</p>
<ul>
<li>Блок агрокультуры</li>
<li>Семена</li>
<li>Урожай (выпадающий предмет)</li>
</ul>
<p>Каждая часть будет рассмотрена независимо и код будет содержать ошибки, так как будут присутствовать ссылки на ещё не созданные объекты, но в конце они будут устранены.</p>
<p>В качестве примера создадим растение кукурузу, зёрна и початки. Приступим.</p>
<h2 id="блок-агрокультуры">Блок агрокультуры<a title="Ссылка на этот раздел" href="#блок-агрокультуры"><i class="material-icons">link</i></a></h2>
<p>Давайте создадим класс под названием <code>BlockCropCorn</code>, который будет унаследован от ванильного <code>BlockCrops</code> и в связи с этим по своей механике будет схож с пшеницей. Что бы сделать агрокультуру более уникальной вы можете ознакомиться с суперклассом и поработать с добавляемыми им методами, их не так много. Наша агрокультура не будет иметь <code>ItemBlock</code> как и все остальные, а значит у неё не будет модели для предмета.</p>
<p>В этом классе нам необходимо переопределить два метода: <code>getSeed()</code> и <code>getCrop()</code>. Первый отвечает за выпадающие семена, второй за предмет-урожай, выпадающий при разрушении растения на финальной стадии созревания.</p>
<pre><code class="java language-java">// ru.austeretony.crops.block.BlockCropCorn.java

public class BlockCropCorn extends BlockCrops {

    private static final AxisAlignedBB[] CROPS_AABB = new AxisAlignedBB[] {

            new AxisAlignedBB(0.4375D, 0.0D, 0.4375D, 0.5625D, 0.25D, 0.5625D),
            new AxisAlignedBB(0.375D, 0.0D, 0.375D, 0.625D, 0.375D, 0.625D),
            new AxisAlignedBB(0.375D, 0.0D, 0.375D, 0.625D, 0.5D, 0.625D),
            new AxisAlignedBB(0.375D, 0.0D, 0.375D, 0.625D, 0.5625D, 0.625D),
            new AxisAlignedBB(0.375D, 0.0D, 0.375D, 0.625D, 0.6875D, 0.625D),
            new AxisAlignedBB(0.375D, 0.0D, 0.375D, 0.625D, 0.875D, 0.625D),
            new AxisAlignedBB(0.3125D, 0.0D, 0.3125D, 0.6875D, 1.0D, 0.6875D),
            new AxisAlignedBB(0.3125D, 0.0D, 0.3125D, 0.6875D, 1.0D, 0.6875D)
    };

    public BlockCropCorn(String cropName) {

        this.setUnlocalizedName(cropName);
        this.setRegistryName(cropName);
    }

    public AxisAlignedBB getBoundingBox(IBlockState blockState, IBlockAccess source, BlockPos position) {

        return CROPS_AABB[(blockState.getValue(this.getAgeProperty())).intValue()];
    }

    @Override
    protected Item getSeed() {

        return ItemsRegistry.CORN_SEED;
    }

    @Override
    protected Item getCrop() {

        return ItemsRegistry.CORN;
    }

    protected int getBonemealAgeIncrease(World world) {

        return MathHelper.getInt(world.rand, 1, 2);
    }

    public EnumPlantType getPlantType(IBlockAccess world, BlockPos position) {

        return EnumPlantType.Crop;     
    }
}
</code></pre>
<p>Как видно конструктор имеет стандартный вид, методы регистрации имён получают их параметром из конструктора блока. Имя мы будем задавать во время регистрации.</p>
<p>Как было отмечено, <code>getSeed()</code> и <code>getCrop()</code> ссылаются но новые объекты, которые будут созданы позже.</p>
<p>Наш класс переопределяет <code>getBoundingBox()</code>, который возвращает разные AABB (объект, отвечающий за физические габариты блока) для каждого <code>Property</code> (свойства) из <code>IBlockState</code> (регистр свойств) блока. Наша агрокультура содержит одно унаследованное <code>Property</code> - "age", представляющее стадии роста - всего их восемь. Если вы хотите изменить количество стадий - создайте собственное <code>Property</code> и верните его в переопредлелённом <code>getAgeProperty()</code>. На каждой стадии роста растение имеет разные размеры и AABB различаются, <code>getBoundingBox()</code> возвращает нужную из массива, созданного в начале класса. Границы AABB в нашем случае определяются размером текстуры блока на разных стадиях роста.</p>
<p>Еще в этом классе переопределён <code>getBonemealAgeIncrease()</code>, отвечающий за то, на сколько стадий роста будет ускорено созревание при применении костной муки. В данном случае он рандомно вернёт значение ускорения на одну или две стадии.</p>
<p>Чтобы при затаптывании грядки с кукурузой она разрушалась, необходимо переопределить <code>getPlantType()</code> и вернуть <code>EnumPlantType#Crop</code>.</p>
<p>Теперь регистрация блока.</p>
<pre><code class="java language-java">// ru.austeretony.crops.main.BlockRegistry.java

public class BlocksRegistry {

    public static final Block
    CROP_CORN = new BlockCropCorn("crop_corn");

    public static void register() {

        setBlockRegister(CROP_CORN);
    }

    private static void setBlockRegister(Block block) {

        ForgeRegistries.BLOCKS.register(block);   
    }
}
</code></pre>
<p>Не забудьте вызвать метод <code>register()</code> в преините <code>CommonProxy</code>.</p>
<p>Теперь нужно создать файл блокстейта для нашей кукурузы. Создайте JSON файл <code>crop_corn.json</code> по пути "src/main/resources/assets/ваш modid/blockstates/"</p>
<pre><code class="json language-json">{
    "forge_marker": 1,
    "defaults": {
        "model": "cross"
    },
    "variants": {
        "age": { "0": { "textures": { "cross": "crops:blocks/corn/stage_0" }},
                 "1": { "textures": { "cross": "crops:blocks/corn/stage_1" }},
                 "2": { "textures": { "cross": "crops:blocks/corn/stage_2" }},
                 "3": { "textures": { "cross": "crops:blocks/corn/stage_3" }},
                 "4": { "textures": { "cross": "crops:blocks/corn/stage_4" }},
                 "5": { "textures": { "cross": "crops:blocks/corn/stage_5" }},
                 "6": { "textures": { "cross": "crops:blocks/corn/stage_6" }},
                 "7": { "textures": { "cross": "crops:blocks/corn/stage_7" }}
        }
    }
}
</code></pre>
<p>Рассмотрим его содержимое подробнее.</p>
<p><code>forge_marker</code> определяет версию блокстейта, всегда равен 1.</p>
<p>Блок <code>defaults</code> содержит указание на используемую модель. Мы будем использовать одну из ванильных моделей. Модель <code>cross</code> представляет собой две скрещенные текстуры (аналогично блокам травы). Вы можете использовать в качестве модели <code>crop</code> которую используют ванильные агрокультуры (в нашем случае для кукурузы лучше смотрится <code>cross</code>).</p>
<p>Блок <code>variants</code> используется для определения текстур, которые должен использовать блок с разными свойствами. В нашем случае свойство "age" использует разные текстуры для всех своих вариантов (восьми стадий роста).</p>
<p>Наша кукуруза использует ванильную модель блока и нет нужды создавать собственную.</p>
<p>Теперь нужно добавить текстуры. В соответствии с блокстейтом их должно быть восемь, скачайте их <a href="https://github.com/AustereTony/Guides/tree/master/1.12.2/Crops/src/main/resources/assets/crops/textures/blocks/corn" target="_blank">отсюда</a> и разместите по пути "src/main/resources/assets/ваш modid/textures/blocks/corn/". Всё, с блоком разобрались.</p>
<h2 id="семена">Семена<a title="Ссылка на этот раздел" href="#семена"><i class="material-icons">link</i></a></h2>
<p>Давайте создадим семена для нашей кукурузы. Создадим класс <code>ItemCornSeed</code>, унаследуем его от <code>ItemSeeds</code>, содержать он будет только конструктор.</p>
<pre><code class="java language-java">// ru.austeretony.crops.items.ItemCornSeeds.java

public class ItemCornSeeds extends ItemSeeds {

    public ItemCornSeeds(String name) {

        super(BlocksRegistry.CROP_CORN, Blocks.FARMLAND);

        setUnlocalizedName(name);
        setRegistryName(name);
    }
}
</code></pre>
<p>В суперконструктор требуется передать объект блока агрокультуры, для которой эти семена предназначены, и "почву", на которой она должна расти. Опытным путём проверено, что второй параметр игрой успешно игнорируется и, независимо от того какой блок мы туда передадим, агрокультуру можно будет посадить только на блок грядки (<code>Blocks#FARMLAND</code>). В конце данного туториала я покажу как можно назначить свой блок для посадки. В остальном конструктор аналогичен конструктору блока.</p>
<p>Регистрируем предмет:</p>
<pre><code class="java language-java">// ru.austeretony.crops.main.ItemsRegistry.java

public class ItemsRegistry {

    public static final Item
    CORN_SEED = new ItemCornSeeds("corn_seed").setCreativeTab(CreativeTabs.FOOD);

    public static void register() {

        setItemRegister(CORN_SEED);
    }

    @SideOnly(Side.CLIENT)
    public static void registerRender() {

        setItemRender(CORN_SEED);
    }

    private static void setItemRegister(Item item) {

        ForgeRegistries.ITEMS.register(item);
    }

    @SideOnly(Side.CLIENT)
    private static void setItemRender(Item item) {

        ModelLoader.setCustomModelResourceLocation(item, 0, new ModelResourceLocation(new ResourceLocation(CropsMain.MODID, item.getUnlocalizedName().substring(5)), "inventory"));
    }
}
</code></pre>
<p>Не забудьте вызвать метод <code>register()</code> в преините <code>CommonProxy</code> и <code>registerRender()</code> в преините <code>ClientProxy</code>.</p>
<p>Семенам требуется модель. Создайте JSON файл <code>corn_seed.json</code> в "models/item"</p>
<pre><code class="json language-json">{
    "parent": "item/generated",
    "textures": {
        "layer0": "crops:items/corn/corn_seed"
    }
}
</code></pre>
<p>В нём указывается что необходимо использовать стандартно генерируемую модель и указанную текстуру для одного слоя.</p>
<p>Скачайте текстуру и разместите её по пути "src/main/resources/assets/ваш modid/textures/items/corn".
Заметьте, мы создаём отдельную папку "corn" в папке текстур для предметов, связанных с кукурузой.</p>
<p><img src="images/corn_seed.png" alt="Текстура семян кукурузы" /></p>
<p>Что ж, идём дальше.</p>
<h2 id="урожай">Урожай<a title="Ссылка на этот раздел" href="#урожай"><i class="material-icons">link</i></a></h2>
<p>В качестве дропа с кукурузы создадим… початок. Создаём ItemCorn и наследуем его от <code>ItemFood</code>, что бы он был полноценной едой.</p>
<pre><code class="java language-java">// ru.austeretony.crops.items.ItemCorn.java

public class ItemCorn extends ItemFood {

    public ItemCorn(String name, int hungerPointsRestoration, float saturationPointsRestoration, boolean isSuitableForWolves) {

        super(hungerPointsRestoration, saturationPointsRestoration, isSuitableForWolves);

        this.setUnlocalizedName(name);
        this.setRegistryName(name);
    }
}
</code></pre>
<p>В суперконструктор <code>ItemFood</code> нужно передать три параметра: кол-во единиц восстанавливаемого голода, значение насыщения и логическую переменную, которая определяет подходит ли данная еда для волков. Всё это будет определено в конструкторе при регистрации предмета.</p>
<p>Регистрируем предмет в классе регистрации предметов. При создании <code>ItemCorn</code> передаём имя, значение восполняемого голода (2 единицы), насыщение и <code>false</code>, если не хотим иметь возможность кормить волков кукурузой.</p>
<pre><code class="java language-java">// ru.austeretony.crops.main.ItemsRegistry.java

public class ItemsRegistry {

    public static final Item
    CORN_SEED = new ItemCornSeeds("corn_seed").setCreativeTab(CreativeTabs.FOOD),
    CORN = new ItemCorn("corn", 2, 0.6F, false).setCreativeTab(CreativeTabs.FOOD);

    public static void register() {

        setItemRegister(CORN_SEED);
        setItemRegister(CORN);
    }

    @SideOnly(Side.CLIENT)
    public static void registerRender() {

        setItemRender(CORN_SEED);
        setItemRender(CORN);
    }

    private static void setItemRegister(Item item) {

        ForgeRegistries.ITEMS.register(item);
    }

    @SideOnly(Side.CLIENT)
    private static void setItemRender(Item item) {

        ModelLoader.setCustomModelResourceLocation(item, 0, new ModelResourceLocation(new ResourceLocation(CropsMain.MODID, item.getUnlocalizedName().substring(5)), "inventory"));
    }
}
</code></pre>
<p>Теперь создаём модель и текстуру. Создайте JSON файл corn.json.</p>
<pre><code class="json language-json">{
    "parent": "item/generated",
    "textures": {
        "layer0": "crops:items/corn/corn"
    }
}
</code></pre>
<p>Текстура:</p>
<p><img src="images/corn.png" alt="Текстура кукурузы" /></p>
<p>Размещение аналогично семенам.</p>
<h2 id="локализация">Локализация<a title="Ссылка на этот раздел" href="#локализация"><i class="material-icons">link</i></a></h2>
<p>Не забудьте локализовать ваши предметы. В файл <code>ru_ru.lang</code> добавьте:</p>
<pre><code>item.corn_seed.name=Семена кукурузы
item.corn.name=Початок кукурузы
</code></pre>
<h2 id="итоги">Итоги<a title="Ссылка на этот раздел" href="#итоги"><i class="material-icons">link</i></a></h2>
<p>Вот так, теперь вы научились создавать агрокультуры. Зайдите в игру, достаньте семена из вкладки "еда" и посадите их на вскопанную грядку. Вырастите их мукой, сломайте - должны выпасть зёрна и початки. Початки вдобавок можно есть.</p>
<p><img src="images/demonstration.png" alt="Демонстрация" /></p>
<h2 id="дополнительно">Дополнительно<a title="Ссылка на этот раздел" href="#дополнительно"><i class="material-icons">link</i></a></h2>
<h3 id="собственная-почва-для-посадки">Собственная почва для посадки<a title="Ссылка на этот раздел" href="#собственная-почва-для-посадки"><i class="material-icons">link</i></a></h3>
<p>Как было отмечено стандартный способ указать подходящую для посадки почву (блок) не работает. Если мы всё же хотим это сделать, то в первую очередь необходимо переопределить <code>onItemUse()</code> в классе семян. Рассмотрим его для начала:</p>
<pre><code class="java language-java">public EnumActionResult onItemUse(EntityPlayer player, World world, BlockPos position, EnumHand hand, EnumFacing facing, float hitX, float hitY, float hitZ) {

    ItemStack itemStack = player.getHeldItem(hand);

    IBlockState blockState = world.getBlockState(position);

    if (facing == EnumFacing.UP &amp;&amp; player.canPlayerEdit(position.offset(facing), facing, itemStack) &amp;&amp; blockState.getBlock().canSustainPlant(blockState, world, position, EnumFacing.UP, this) &amp;&amp; world.isAirBlock(position.up())) {

        world.setBlockState(position.up(), this.getPlant(world, position));

        if (player instanceof EntityPlayerMP) {

            CriteriaTriggers.PLACED_BLOCK.trigger((EntityPlayerMP) player, position.up(), itemStack);
        }

        itemStack.shrink(1);

        return EnumActionResult.SUCCESS;
    }

    return EnumActionResult.FAIL;
}
</code></pre>
<p>Нас интерисует часть условия <code>state.getBlock().canSustainPlant()</code>. Вызов метода <code>canSustainPlant()</code> для блока на который мы ходим посадить наши семена вернёт true только для блока грядки. Просто вырезаем эту часть (или добавляем дополнительно нашу проверку) и заменяем сравнением блока с нужным. В итоге метод выглядит примерно так:</p>
<pre><code class="java language-java">public EnumActionResult onItemUse(EntityPlayer player, World world, BlockPos position, EnumHand hand, EnumFacing facing, float hitX, float hitY, float hitZ) {

    ItemStack itemStack = player.getHeldItem(hand);

    IBlockState blockState = world.getBlockState(position);

    if (facing == EnumFacing.UP &amp;&amp; player.canPlayerEdit(position.offset(facing), facing, itemStack) &amp;&amp; blockState.getBlock() == Blocks.GRASS &amp;&amp; world.isAirBlock(position.up())) {

        world.setBlockState(position.up(), this.getPlant(world, position));

        if (player instanceof EntityPlayerMP) {

            CriteriaTriggers.PLACED_BLOCK.trigger((EntityPlayerMP) player, position.up(), itemStack);
        }

        itemStack.shrink(1);

        return EnumActionResult.SUCCESS;
    }

    return EnumActionResult.FAIL;
}
</code></pre>
<p>Теперь необходимо удостоверить нашу агрокультуру, что она может расти на указанном блоке. В классе блока переопределяем <code>canBlockStay()</code> и заменяем аналогичный вызов проверки на сравнение блока со своим. Итог:</p>
<pre><code class="java language-java">public boolean canBlockStay(World world, BlockPos position, IBlockState state) {

    IBlockState soil = world.getBlockState(position.down());

    return (world.getLight(position) &gt;= 8 || world.canSeeSky(position)) &amp;&amp; soil.getBlock() == Blocks.GRASS;
}
</code></pre>
<p>Теперь вы можете сажать свою агрокультуру только на траву.</p>

    </div>

    <section class="next-previous-articles">

        <a class="previous-article" title="Переход на предыдущую статью" href="http:&#x2F;&#x2F;mcmodding.ru&#x2F;book&#x2F;1.12+&#x2F;forge&#x2F;achievements&#x2F;prep">
            <svg xmlns="http://www.w3.org/2000/svg" width="32" heigth="32" viewBox="0 0 512 512" class="previous-icon">
                <path d="M16 256l240 240v-144h256v-192h-256v-144z"></path>
            </svg>
            <span class="label">Предыдущая статья</span>
        </a>

        <div class="sep"></div>

        <a class="next-article" title="Переход на следующую статью" href="http:&#x2F;&#x2F;mcmodding.ru&#x2F;book&#x2F;1.12+&#x2F;forge&#x2F;advanced&#x2F;layers">
            <span class="label">Следующая статья</span>
            <svg xmlns="http://www.w3.org/2000/svg" width="32" heigth="32" viewBox="0 0 512 512" class="next-icon">
                <path d="M496 256l-240-240v144h-256v192h256v144z"></path>
            </svg>
        </a>

    </section>

    <section class="contributors">


            <a href="https://github.com/CMTV" target="_blank" title="К профилю GitHub" class="contributor">

                <img class="avatar" src="https://github.com/CMTV.png?size=40">

                <div class="info">

                    <div class="name">CMTV</div>

                    <div class="role">Перенес с форума</div>

                </div>

            </a>


    </section>

    <section class="ad-after-article">

        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <!-- McModding Book Под статьей -->
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-client="ca-pub-8094912170389944"
             data-ad-slot="4828749197"
             data-ad-format="auto"></ins>
        <script>
            (adsbygoogle = window.adsbygoogle || []).push({});
        </script>

    </section>

    <section class="disqus">

        <div id="disqus_thread"></div>
        <script>

            var disqus_config = function () {
                this.page.identifier = 'http://mcmodding.ru/book/1.12+/forge/plant/base';
            };

            (function() { // DON'T EDIT BELOW THIS LINE
                var d = document, s = d.createElement('script');
                s.src = 'https://mcmodding.disqus.com/embed.js';
                s.setAttribute('data-timestamp', +new Date());
                (d.head || d.body).appendChild(s);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

    </section>

    <div class="site-info">

        <a href="https://github.com/mc-modding/mc-modding-book/commits/master" target="_blank" class="copyright">mcmodding.ru</a>

        <a class="version-link" title="Последние изменения" href="https://github.com/mc-modding/mc-modding-book/commits/master" target="_blank">v1.1.1</a>

    </div>

</article>
<!-- Yandex.Metrika counter -->
<script type="text/javascript">
    (function (d, w, c) {
        (w[c] = w[c] || []).push(function() {
            try {
                w.yaCounter21621697 = new Ya.Metrika({
                    id:21621697,
                    clickmap:true,
                    trackLinks:true,
                    accurateTrackBounce:true,
                    webvisor:true
                });
            } catch(e) { }
        });

        var n = d.getElementsByTagName("script")[0],
                s = d.createElement("script"),
                f = function () { n.parentNode.insertBefore(s, n); };
        s.type = "text/javascript";
        s.async = true;
        s.src = "https://mc.yandex.ru/metrika/watch.js";

        if (w.opera == "[object Opera]") {
            d.addEventListener("DOMContentLoaded", f, false);
        } else { f(); }
    })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/21621697" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->

<!-- Google Analytics -->
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-42024721-1', 'auto');
    ga('send', 'pageview');

</script>
<!-- /Google Analytics -->
</body>
</html>