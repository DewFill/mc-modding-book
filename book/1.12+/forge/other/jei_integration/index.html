<!DOCTYPE html>
<html>
<head>

<title>Интеграция с Just Enough Items - Minecraft Modding</title>

<meta charset="UTF-8">

<link rel="icon" href="http://mcmodding.ru/favicon_standart.png">

<meta name="description" content="Реализация поддержки Just Enough Items (JEI) для своего мода с наглядными примерами.">

<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Google Material Icons -->
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

<meta property="og:title"       content="Интеграция с Just Enough Items - Minecraft Modding">
<meta property="og:description" content="Реализация поддержки Just Enough Items (JEI) для своего мода с наглядными примерами.">
<meta property="og:type"        content="article">
<meta property="og:url"         content="http://mcmodding.ru/book/1.12+/forge/other/jei_integration">
<meta property="og:image"       content="http://mcmodding.ru/favicon_standart.png">
<!-- jQuery -->
<script src="http://mcmodding.ru/libs/jQuery/jquery-3.2.0.min.js"></script>

<!-- Hammer.js -->
<script src="http://mcmodding.ru/libs/hammer/hammer.min.js"></script>

<!-- Include scrollbar width in site width -->
<script src="http://mcmodding.ru/libs/mq.genie/mq.genie.min.js"></script>

<!-- highlight.js -->
<link href="http://mcmodding.ru/libs/highlight/styles/idea.css" rel="stylesheet">
<style>
    pre code.hljs {
        display: block;
    }

    code.hljs {
        display: inline;
    }
</style>
<script src="http://mcmodding.ru/libs/highlight/highlight.pack.js"></script>
<script>
    $(() => {
        $('pre code').each( (i, element) => {
            hljs.highlightBlock(element);
        });
    });
</script>

<!-- Magnific Popup -->
<link rel="stylesheet" href="http://mcmodding.ru/libs/magnific-popup/magnific-popup.min.css">
<script src="http://mcmodding.ru/libs/magnific-popup/magnific-popup.min.js"></script>
<script>
    $(() => {
        $('article .inner').magnificPopup({
            delegate: 'img',
            type: 'image',
            callbacks: {
                elementParse: (item) => { item.src = item.el.attr('src'); }
            }
        });
    });
</script>

<!-- Snap.svg -->
<script src="http://mcmodding.ru/libs/snap.svg/snap.svg-min.js"></script>
<!-- Global CSS -->
<link href="http://mcmodding.ru/g-styles/global.min.css" rel="stylesheet">

<!-- Book CSS -->
<link href="http://mcmodding.ru/book/styles/book.min.css" rel="stylesheet">

<!-- Book JS -->
<script>
    let book_id = '1.12+-forge';
</script>
<script src="http://mcmodding.ru/book/scripts/book.min.js"></script>
</head>
<body>

<header>
    <div class="inner">

        <div class="site-menu show-book-nav">
            <div title="Оглавление учебника" class="menu-item">
                <i class="material-icons">menu</i>
            </div>
        </div>

        <div id="logotype">
            <div class="cube">
                    <img src="http://mcmodding.ru/logotype/emerald/all.png" class="side front">
                    <img src="http://mcmodding.ru/logotype/emerald/all.png" class="side back">
                    <img src="http://mcmodding.ru/logotype/emerald/all.png" class="side left">
                    <img src="http://mcmodding.ru/logotype/emerald/all.png" class="side right">
                    <img src="http://mcmodding.ru/logotype/emerald/all.png" class="side top">
                    <img src="http://mcmodding.ru/logotype/emerald/all.png" class="side bottom">
            </div>
        </div>

        <div class="site-info">
            <div class="title">Minecraft Modding</div>
            <div class="description">Учебник по созданию Minecraft модов</div>
        </div>

        <div class="site-menu show-menu">
            <div class="menu-item">
                <i title="Меню сайта" class="material-icons">more_horiz</i>
            </div>
        </div>

        <div class="site-menu transformable">

            <a href="http://mcmodding.ru" title="Главная" class="menu-item">
                <i class="material-icons">home</i><span>Главная</span>
            </a>

            <a href="http://mcmodding.ru/book/1.12+/forge/prep/install" title="Учебник" class="menu-item">
                <i class="material-icons">import_contacts</i><span>Учебник</span>
            </a>

            <a href="http://forum.mcmodding.ru/newthread.php?fid=23" target="_blank" title="Спросить" class="menu-item">
                <i class="material-icons">help_outline</i><span>Спросить</span>
            </a>

            <a href="http://forum.mcmodding.ru" target="_blank" title="Форум" class="menu-item">
                <i class="material-icons">forum</i><span>Форум</span>
            </a>

        </div>

    </div>
</header>
<nav>

    <div class="inner">

        <section class="book-choose">


                <div class="version-choose">
                    <label>Версия:
                        <select onChange="window.location.href=this.value">

                                <optgroup label="Релиз">
                                        <option value="http://mcmodding.ru/book/1.12+/forge/prep/install" selected>1.12+</option>
                                        <option value="http://mcmodding.ru/book/1.11+/forge/prep/install" >1.11+</option>
                                        <option value="http://mcmodding.ru/book/1.7.10/forge/base/first_steps" >1.7.10</option>
                                </optgroup>



                        </select>
                    </label>
                </div>


            <div class="api-choose">
                <label>API:
                    <select onChange="window.location.href=this.value">
                            <option value="http://mcmodding.ru/book/1.12+/forge/prep/install" selected>Forge</option>
                    </select>
                </label>
            </div>

        </section>

        <div class="categories">
                <div class="category">

                    <div class="category-header">
                        <a href="http://mcmodding.ru/book/1.12+/forge/prep/install" class="category-article ">Подготовка</a>

                        <svg xmlns="http://www.w3.org/2000/svg" title="Раскрыть/скрыть категорию" class="visibility-switcher switcher-0 closed" width="16" height="16" viewBox="0 0 512 512">
                            <rect class="horizontal-rect" x="0" y="192" width="512" height="128" rx="15" ry="15"/>
                            <rect class="vertical-rect"   x="192" y="0" width="128" height="512" rx="15" ry="15"/>
                        </svg>
                    </div>

                    <div class="category-articles">
                            <a href="http://mcmodding.ru/book/1.12+/forge/prep/install" class="article ">Установка программ</a>
                            <a href="http://mcmodding.ru/book/1.12+/forge/prep/setup_idea" class="article ">Использование Idea</a>
                            <a href="http://mcmodding.ru/book/1.12+/forge/prep/setup_eclipse" class="article ">Использование Eclipse</a>
                            <a href="http://mcmodding.ru/book/1.12+/forge/prep/off_skin" class="article ">Собственный скин</a>
                            <a href="http://mcmodding.ru/book/1.12+/forge/prep/problems" class="article ">Решение проблем</a>
                    </div>

                </div>
                <hr>
                <div class="category">

                    <div class="category-header">
                        <a href="http://mcmodding.ru/book/1.12+/forge/base/mod_structure" class="category-article ">Основы Forge</a>

                        <svg xmlns="http://www.w3.org/2000/svg" title="Раскрыть/скрыть категорию" class="visibility-switcher switcher-1 closed" width="16" height="16" viewBox="0 0 512 512">
                            <rect class="horizontal-rect" x="0" y="192" width="512" height="128" rx="15" ry="15"/>
                            <rect class="vertical-rect"   x="192" y="0" width="128" height="512" rx="15" ry="15"/>
                        </svg>
                    </div>

                    <div class="category-articles">
                            <a href="http://mcmodding.ru/book/1.12+/forge/base/mod_structure" class="article ">Структура мода</a>
                            <a href="http://mcmodding.ru/book/1.12+/forge/base/mod_annotation" class="article ">Аннотация @Mod</a>
                            <a href="http://mcmodding.ru/book/1.12+/forge/base/loading_stages" class="article ">Стадии загрузки мода</a>
                            <a href="http://mcmodding.ru/book/1.12+/forge/base/proxy" class="article ">Прокси</a>
                            <a href="http://mcmodding.ru/book/1.12+/forge/base/build_mod" class="article ">Сборка мода</a>
                    </div>

                </div>
                <hr>
                <div class="category">

                    <div class="category-header">
                        <a href="http://mcmodding.ru/book/1.12+/forge/item/base" class="category-article ">Предметы</a>

                        <svg xmlns="http://www.w3.org/2000/svg" title="Раскрыть/скрыть категорию" class="visibility-switcher switcher-2 closed" width="16" height="16" viewBox="0 0 512 512">
                            <rect class="horizontal-rect" x="0" y="192" width="512" height="128" rx="15" ry="15"/>
                            <rect class="vertical-rect"   x="192" y="0" width="128" height="512" rx="15" ry="15"/>
                        </svg>
                    </div>

                    <div class="category-articles">
                            <a href="http://mcmodding.ru/book/1.12+/forge/item/base" class="article ">Создание предмета</a>
                            <a href="http://mcmodding.ru/book/1.12+/forge/item/food" class="article ">Еда</a>
                            <a href="http://mcmodding.ru/book/1.12+/forge/item/tools" class="article ">Инструменты и меч</a>
                            <a href="http://mcmodding.ru/book/1.12+/forge/item/repair" class="article ">Починка инструментов</a>
                            <a href="http://mcmodding.ru/book/1.12+/forge/item/armor" class="article ">Броня</a>
                            <a href="http://mcmodding.ru/book/1.12+/forge/item/metadata" class="article ">Метадата</a>
                            <a href="http://mcmodding.ru/book/1.12+/forge/item/nbt" class="article ">Хранение в предмете</a>
                            <a href="http://mcmodding.ru/book/1.12+/forge/item/loot" class="article ">Система лута</a>
                            <a href="http://mcmodding.ru/book/1.12+/forge/item/rarity" class="article ">Редкость предметов</a>
                    </div>

                </div>
                <hr>
                <div class="category">

                    <div class="category-header">
                        <a href="http://mcmodding.ru/book/1.12+/forge/block/base" class="category-article ">Блоки</a>

                        <svg xmlns="http://www.w3.org/2000/svg" title="Раскрыть/скрыть категорию" class="visibility-switcher switcher-3 closed" width="16" height="16" viewBox="0 0 512 512">
                            <rect class="horizontal-rect" x="0" y="192" width="512" height="128" rx="15" ry="15"/>
                            <rect class="vertical-rect"   x="192" y="0" width="128" height="512" rx="15" ry="15"/>
                        </svg>
                    </div>

                    <div class="category-articles">
                    </div>

                </div>
                <hr>
                <div class="category">

                    <div class="category-header">
                        <a href="http://mcmodding.ru/book/1.12+/forge/creativetab/base" class="category-article ">Вкладка в креативе</a>

                        <svg xmlns="http://www.w3.org/2000/svg" title="Раскрыть/скрыть категорию" class="visibility-switcher switcher-4 closed" width="16" height="16" viewBox="0 0 512 512">
                            <rect class="horizontal-rect" x="0" y="192" width="512" height="128" rx="15" ry="15"/>
                            <rect class="vertical-rect"   x="192" y="0" width="128" height="512" rx="15" ry="15"/>
                        </svg>
                    </div>

                    <div class="category-articles">
                    </div>

                </div>
                <hr>
                <div class="category">

                    <div class="category-header">
                        <a href="http://mcmodding.ru/book/1.12+/forge/lang/base" class="category-article ">Локализация</a>

                        <svg xmlns="http://www.w3.org/2000/svg" title="Раскрыть/скрыть категорию" class="visibility-switcher switcher-5 closed" width="16" height="16" viewBox="0 0 512 512">
                            <rect class="horizontal-rect" x="0" y="192" width="512" height="128" rx="15" ry="15"/>
                            <rect class="vertical-rect"   x="192" y="0" width="128" height="512" rx="15" ry="15"/>
                        </svg>
                    </div>

                    <div class="category-articles">
                    </div>

                </div>
                <hr>
                <div class="category">

                    <div class="category-header">
                        <a href="http://mcmodding.ru/book/1.12+/forge/events/base" class="category-article ">События</a>

                        <svg xmlns="http://www.w3.org/2000/svg" title="Раскрыть/скрыть категорию" class="visibility-switcher switcher-6 closed" width="16" height="16" viewBox="0 0 512 512">
                            <rect class="horizontal-rect" x="0" y="192" width="512" height="128" rx="15" ry="15"/>
                            <rect class="vertical-rect"   x="192" y="0" width="128" height="512" rx="15" ry="15"/>
                        </svg>
                    </div>

                    <div class="category-articles">
                            <a href="http://mcmodding.ru/book/1.12+/forge/events/base" class="article ">Использование событий</a>
                            <a href="http://mcmodding.ru/book/1.12+/forge/events/table" class="article ">Таблица событий</a>
                    </div>

                </div>
                <hr>
                <div class="category">

                    <div class="category-header">
                        <a href="http://mcmodding.ru/book/1.12+/forge/craftsmeltingandbrewing/craft" class="category-article ">Рецепты</a>

                        <svg xmlns="http://www.w3.org/2000/svg" title="Раскрыть/скрыть категорию" class="visibility-switcher switcher-7 closed" width="16" height="16" viewBox="0 0 512 512">
                            <rect class="horizontal-rect" x="0" y="192" width="512" height="128" rx="15" ry="15"/>
                            <rect class="vertical-rect"   x="192" y="0" width="128" height="512" rx="15" ry="15"/>
                        </svg>
                    </div>

                    <div class="category-articles">
                    </div>

                </div>
                <hr>
                <div class="category">

                    <div class="category-header">
                        <a href="http://mcmodding.ru/book/1.12+/forge/achievements/prep" class="category-article ">Достижения</a>

                        <svg xmlns="http://www.w3.org/2000/svg" title="Раскрыть/скрыть категорию" class="visibility-switcher switcher-8 closed" width="16" height="16" viewBox="0 0 512 512">
                            <rect class="horizontal-rect" x="0" y="192" width="512" height="128" rx="15" ry="15"/>
                            <rect class="vertical-rect"   x="192" y="0" width="128" height="512" rx="15" ry="15"/>
                        </svg>
                    </div>

                    <div class="category-articles">
                            <a href="http://mcmodding.ru/book/1.12+/forge/achievements/prep" class="article ">Начало</a>
                            <a href="http://mcmodding.ru/book/1.12+/forge/achievements/base" class="article ">Создание достижения</a>
                            <a href="http://mcmodding.ru/book/1.12+/forge/achievements/recipes" class="article ">Получение рецептов</a>
                    </div>

                </div>
                <hr>
                <div class="category">

                    <div class="category-header">
                        <a href="http://mcmodding.ru/book/1.12+/forge/advanced/layers" class="category-article ">Продвинутые статьи</a>

                        <svg xmlns="http://www.w3.org/2000/svg" title="Раскрыть/скрыть категорию" class="visibility-switcher switcher-9 closed" width="16" height="16" viewBox="0 0 512 512">
                            <rect class="horizontal-rect" x="0" y="192" width="512" height="128" rx="15" ry="15"/>
                            <rect class="vertical-rect"   x="192" y="0" width="128" height="512" rx="15" ry="15"/>
                        </svg>
                    </div>

                    <div class="category-articles">
                            <a href="http://mcmodding.ru/book/1.12+/forge/advanced/layers" class="article ">Слои</a>
                            <a href="http://mcmodding.ru/book/1.12+/forge/advanced/keybinds" class="article ">Привязка клавиш</a>
                            <a href="http://mcmodding.ru/book/1.12+/forge/advanced/buffs" class="article ">Система временных эффектов</a>
                            <a href="http://mcmodding.ru/book/1.12+/forge/advanced/sounds" class="article ">Звуки</a>
                    </div>

                </div>
                <hr>
                <div class="category">

                    <div class="category-header">
                        <a href="http://mcmodding.ru/book/1.12+/forge/other/sources" class="category-article selected">Дополнительно</a>

                        <svg xmlns="http://www.w3.org/2000/svg" title="Раскрыть/скрыть категорию" class="visibility-switcher switcher-10 closed" width="16" height="16" viewBox="0 0 512 512">
                            <rect class="horizontal-rect" x="0" y="192" width="512" height="128" rx="15" ry="15"/>
                            <rect class="vertical-rect"   x="192" y="0" width="128" height="512" rx="15" ry="15"/>
                        </svg>
                    </div>

                    <div class="category-articles">
                            <a href="http://mcmodding.ru/book/1.12+/forge/other/sources" class="article ">Исходники Minecraft</a>
                            <a href="http://mcmodding.ru/book/1.12+/forge/other/jei_integration" class="article selected">Интеграция с Just Enough Items</a>
                            <a href="http://mcmodding.ru/book/1.12+/forge/other/access_transformers" class="article ">Access Transformers</a>
                    </div>

                </div>
                <hr>
        </div>

        <section class="ad-after-nav">

            <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
            <!-- MCModding Book - Реклама под навигацией -->
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-8094912170389944"
                 data-ad-slot="5398483104"
                 data-ad-format="auto"></ins>
            <script>
                (adsbygoogle = window.adsbygoogle || []).push({});
            </script>

        </section>

    </div>

</nav><article>

    <div class="inner">

        <a href="https://github.com/mc-modding/mc-modding-book/blob/master/book/1.12+/forge/other/jei_integration/article.md" target="_blank" class="edit-article"><i class="material-icons">mode_edit</i><span>Редактировать</span></a>

        <h1 id="интеграция-с-just-enough-items">Интеграция с Just Enough Items<a title="Ссылка на этот раздел" href="#интеграция-с-just-enough-items"><i class="material-icons">link</i></a></h1>
<p>Автор статьи — <a href="https://forum.mcmodding.ru/members/doc.7271/" target="_blank">Doc</a>.</p>
<p>Рабочий тестовый мод с материалами данной статьи можно скачать <a href="images/jei.rar" target="_blank">здесь</a>.</p>
<p>Данный мини-ресурс дает поддержку Just Enough Items (JEI) для Вашего мода.
Рассчитан на тех, кто может сам зарегистрировать мод/блок/итем/модель.
Много информации расписано в самих классах.</p>
<p>Начнем.</p>
<p>Для начала мы импортируем сам мод в IDE.
В gradlew.build добавим это:</p>
<pre><code class="java language-java">repositories {
  maven { // Мавен, который поддерживает JEI.
    name = "Progwml6 maven"
    url = "http://dvs1.progwml6.com/files/maven"
  }
  maven { // Мавен, который поддерживает JEI, для резерва.
    name = "ModMaven"
    url = "modmaven.k-4u.nl"
  }
}

dependencies { // Добавляем сам JEI.
  deobfProvided "mezz.jei:jei_${mc_version}:${jei_version}:api"
  runtime "mezz.jei:jei_${mc_version}:${jei_version}"
}
</code></pre>
<p><code>${mc_version}</code> и <code>${jei_version}</code> можно либо заменить на ту, что нужно, либо же для удобства добавить эти переменные в gradle.properties:</p>
<pre><code class="java language-java">mc_version=1.12.2
jei_version=4.8.5.137
</code></pre>
<p>Далее рассмотрим классы.
Базовые классы, которые нужны для регистрации мода/блока/предмета/модели рассматривать не будем. (#МыЖНеНубы)</p>
<p>Рассмотрим блок, на примере которого будем делать свою поддержку для JEI.
Сам по себе блок - добавляет дроп земли (5 шт) и алмазных блоков (64 шт).
По стандарту - этот дроп не показывается майном. Значит нужно это нужно добавить самим.</p>
<pre><code class="java language-java">// BlockDrops.java

package xzchtoeto;

import net.minecraft.block.Block;
import net.minecraft.block.material.Material;
import net.minecraft.block.state.IBlockState;
import net.minecraft.client.renderer.block.model.ModelResourceLocation;
import net.minecraft.creativetab.CreativeTabs;
import net.minecraft.init.Blocks;
import net.minecraft.item.Item;
import net.minecraft.item.ItemStack;
import net.minecraft.util.NonNullList;
import net.minecraft.util.math.BlockPos;
import net.minecraft.world.IBlockAccess;
import net.minecraftforge.client.model.ModelLoader;
import net.minecraftforge.fml.relauncher.Side;
import net.minecraftforge.fml.relauncher.SideOnly;

public class BlockDrops extends Block {

    public BlockDrops() {
        super(Material.GROUND); // Материал блока.
        setCreativeTab(CreativeTabs.REDSTONE); // Креативная вкладка.
        setRegistryName(TestMod.MODID, "drop"); // Название блока при регистрации.
        setUnlocalizedName(TestMod.MODID + ".drop"); // Название нелокализированного блока.
    }

    @Override // Дропы, которые получим при ломании блока.
    public void getDrops(NonNullList&lt;ItemStack&gt; drops, IBlockAccess world, BlockPos pos, IBlockState s, int f) {
        drops.clear(); // Отчищаем возможные дропы, если они есть.
        drops.add(new ItemStack(Blocks.STONE, 5)); // Добавляем свой дроп.
        drops.add(new ItemStack(Blocks.DIAMOND_BLOCK, 64)); // Добавляем свой дроп.
    }

    @SideOnly(Side.CLIENT)
    public void initModel() { // Модель блока
        ModelLoader.setCustomModelResourceLocation(Item.getItemFromBlock(this), 0,
                new ModelResourceLocation(getRegistryName(), "inventory"));
    }
}
</code></pre>
<p>Рассмотрим класс, который добавляет поддержку JEI.</p>
<pre><code class="java language-java">// JEIPluginTM.java

package xzchtoeto.jei;

import com.google.common.collect.Lists;

import mezz.jei.api.IModPlugin;
import mezz.jei.api.IModRegistry;
import mezz.jei.api.JEIPlugin;
import mezz.jei.api.ingredients.IIngredientBlacklist;
import mezz.jei.api.recipe.IRecipeCategoryRegistration;
import net.minecraft.init.Blocks;
import net.minecraft.item.ItemStack;
import xzchtoeto.TMRegistry;
import xzchtoeto.jei.drops.DropsRecipeCategory;
import xzchtoeto.jei.drops.DropsRecipeWrapper;

@JEIPlugin // Сам JEI плагин.
public class JEIPluginTM implements IModPlugin {

    @Override
    public void registerCategories(IRecipeCategoryRegistration registry) { // Регистрация категории, которая будет показываться в MC.
        registry.addRecipeCategories(new DropsRecipeCategory(registry.getJeiHelpers().getGuiHelper()));
    }

    @Override
    public void register(IModRegistry registry) {
        registry.addRecipes(Lists.newArrayList(new DropsRecipeWrapper()), DropsRecipeCategory.UID); // Регистрация рецептов для Вашего UID.
        registry.addRecipeCatalyst(new ItemStack(TMRegistry.blockDrops), DropsRecipeCategory.UID); // Регистрация показывающихся блоков для Вашего UID.

        IIngredientBlacklist blackList = registry.getJeiHelpers().getIngredientBlacklist(); // Блек лист для JEI, используемый для скрытия предметов.
        blackList.addIngredientToBlacklist(new ItemStack(Blocks.DIRT)); // Скрытие блока земли из JEI.
    }
}
</code></pre>
<p>Если Вам нужно больше рецептов - делаем цикл и не много изменяем класс DropsRecipeWrapper.</p>
<p>Далее рассмотрим класс, который добавляет рецепт.</p>
<pre><code class="java language-java">// DropsRecipeWrapper

package xzchtoeto.jei.drops;

import mezz.jei.api.ingredients.IIngredients;
import mezz.jei.api.recipe.IRecipeWrapper;
import net.minecraft.item.ItemStack;
import net.minecraft.util.NonNullList;
import xzchtoeto.TMRegistry;

public class DropsRecipeWrapper implements IRecipeWrapper {

    private ItemStack input; // Объявление входного предмета для рецепта.
    private NonNullList&lt;ItemStack&gt; outputs; // Объявление выходного листа для рецепта.

    public DropsRecipeWrapper() { // Сам рецепт. Так же можно передавать сюда свои рецепты и разбирать его на входные/выходные предметы.
        input = new ItemStack(TMRegistry.blockDrops); // Собственно сам входной предмет.
        outputs = NonNullList.create(); // Делаем лист.
        TMRegistry.blockDrops.getDrops(outputs, null, null, null, 0); // Получаем все дропы с блока и заносим в созданный ранее лист.
    }

    @Override
    public void getIngredients(IIngredients ingredients) { // Ингридиенты рецепта.
        ingredients.setInput(ItemStack.class, input); // Входные ингридиенты.
        ingredients.setOutputs(ItemStack.class, outputs); // Выходные ингридиенты.
    }

    public ItemStack getInput() {
        return input;
    }

    public NonNullList&lt;ItemStack&gt; getOutputs() {
        return outputs;
    }
}
</code></pre>
<p>Идем далее. Рассмотрим класс, который добавляет ту самую категорию, которая будет видна в JEI.</p>
<pre><code class="java language-java">// DropsRecipeCategory.java

package xzchtoeto.jei.drops;

import mezz.jei.api.IGuiHelper;
import mezz.jei.api.gui.IDrawable;
import mezz.jei.api.gui.IDrawableStatic;
import mezz.jei.api.gui.IGuiItemStackGroup;
import mezz.jei.api.gui.IRecipeLayout;
import mezz.jei.api.ingredients.IIngredients;
import mezz.jei.api.recipe.IRecipeCategory;
import net.minecraft.client.Minecraft;
import net.minecraft.item.ItemStack;
import net.minecraft.util.ResourceLocation;
import xzchtoeto.TestMod;

public class DropsRecipeCategory implements IRecipeCategory&lt;DropsRecipeWrapper&gt; {

    public static final String UID = TestMod.MODID + ":drops"; // Сам UID рецепт.

    private final IDrawableStatic bg; // "Background"

    public DropsRecipeCategory(IGuiHelper h) {
        bg = h.createDrawable(new ResourceLocation(TestMod.MODID, "textures/gui/jei_drops.png"), 0, 0, 166, 128); // Объявление background'а.
        // Текстура должна быть своя. Переменные - 0, 0 - начало, 166, 128 сама текстура. (Вроде бы)
    }

    @Override
    public String getUid() { // UID рецепта.
        return UID;
    }

    @Override
    public String getTitle() { // Название вкладки в MC, можно использовать I18n переводчик.
        return "Drops";
    }

    @Override
    public String getModName() { // Название мода.
        return TestMod.MODNAME;
    }

    @Override
    public IDrawable getBackground() {
        return bg;
    }

    @Override
    public void drawExtras(Minecraft mc) { // Любые надписи, которые будут на каждом рецепте.
        // Все координаты идут относительно самого рецепта. Все width и height рассчитывать не нужно.
        mc.fontRenderer.drawString("Block drops:", 5, 13, 0xffffffff, true);
    }

    @Override
    public void setRecipe(IRecipeLayout layout, DropsRecipeWrapper recipes, IIngredients ingredients) {

        IGuiItemStackGroup isg = layout.getItemStacks(); // Группа ItemStack, которая нужна для рендера.
        // Все координаты идут относительно самого рецепта. Все width и height рассчитывать не нужно.
        isg.init(0, true, 74, 9); // Инициализируем слот 0. true/false - это обозначение того, является ли слот *ВХОДНЫМ*, true - да, false - нет. Остальные 2 числа - координаты. X/Y.
        isg.set(0, recipes.getInput()); // Добавляем в слот 0 входной предмет.

        int slotIndex = 1;

        for (int i = 0; i &lt; recipes.getOutputs().size(); i++) { // Циклом пробегаем массив всех выходных предметов рецепта.
            final int slotX = 2 + i % 9 * 18; // Координаты слота по X. По дефолту - 2, после изменяется в зависимости от i.
            final int slotY = 36 + i / 9 * 18; // Координаты слота по Y. По дефолту - 36, после изменяется в зависимости от i.

            ItemStack output = recipes.getOutputs().get(i); // Получаем элемент из массива дропа блока.

            isg.init(slotIndex + i, false, slotX, slotY); // Инициализируем слот (slotIndex).  true/false - это обозначение того, является ли слот *ВХОДНЫМ*, true - да, false - нет. Остальные 2 числа - координаты. X/Y.
            isg.set(slotIndex + i, output); // Добавляем в слот (slotIndex) выходной предмет.
        }
    }
}
</code></pre>
<p>В итоге получаем такую картину:
<img src="images/drops_demonstration.png" alt="Демонстрация дропа блока в JEI" /></p>
<p>Но, мы захотели создать не просто блок с своим дропом, а целый механизм!</p>
<p>Займемся рецептами:</p>
<pre><code class="java language-java">// CrafterRecipe.java

package xzchtoeto.crafter;

import java.util.ArrayList;
import java.util.List;

import net.minecraft.block.Block;
import net.minecraft.init.Blocks;
import net.minecraft.init.Items;
import net.minecraft.item.Item;
import net.minecraft.item.ItemStack;

public class CrafterRecipe {

    private static List&lt;CrafterRecipe&gt; recipes = new ArrayList&lt;CrafterRecipe&gt;(); // Лист всех рецептов.

    public static List&lt;CrafterRecipe&gt; getRecipes() { // Получатель всех рецептов.
        return recipes;
    }

    private final ItemStack input, output; // Компоненты крафта.

    public CrafterRecipe(ItemStack input, ItemStack output) { // Конструктор рецепта.
        this.input = input;
        this.output = output;
    }

    public ItemStack getInput() { // Получатель входного предмета рецепта.
        return input;
    }

    public ItemStack getOutput() { // Получатель выходного предмета рецепта.
        return output.copy();
    }

    public static CrafterRecipe addRecipe(ItemStack input, ItemStack output) { // Метод добавления рецепта.
        CrafterRecipe recipe = new CrafterRecipe(input, output); // Создаем рецепт.
        if (recipes.contains(recipe)) // Если он есть уже в рецептах - игнорим.
            return null;
        recipes.add(recipe); // Если же нет - добавляем.
        return recipe;
    }

    public static CrafterRecipe getRecipe(ItemStack is) { // Получатель рецепта через входной предмет.
        if (is == null || is.isEmpty())
            return null;
        for (CrafterRecipe recipe : recipes) // Проходим по списку всех рецептов.
            if (recipe.matchesInput(is)) // Сравниваем входные элементы.
                return recipe; // Возвращаем рецепт, если входные элементы одинаковые.
        return null;
    }

    public boolean matchesInput(ItemStack is) {
        return is.getItem() == input.getItem();
    }

    public static void initRecipes() { // Метод регистрации рецептов.
        addRecipe(is(Items.DIAMOND), is(Blocks.DIAMOND_BLOCK));
        addRecipe(is(Items.COAL), is(Blocks.COAL_BLOCK));
    }

    private static ItemStack is(Item item) { // Побочный метод.
        return new ItemStack(item);
    }

    private static ItemStack is(Block block) { // Побочный метод.
        return new ItemStack(block);
    }
}
</code></pre>
<p>Метод инициализации можно вызывать в любой стадии инициализации мода. (вроде бы, я юзаю в preInit)</p>
<p>Далее сам блок. Рассмотрим только метод добавления предмета в тайл, ибо остальное (регистрацию) Вы должны знать сами. (P.S. Не забудьте добавить, что он имеет тайл)
Этот блок получает предмет, проверяется рецепт, дропает выходной итем рецепта.
Все это можно было организовать и без тайла, но для примера он с тайлом.</p>
<pre><code class="java language-java">// CrafterBlock.java

@Override
public boolean onBlockActivated(World w, BlockPos pos, IBlockState s, EntityPlayer p, EnumHand h, EnumFacing f,
        float hitX, float hitY, float hitZ) {
    if (!w.isRemote &amp;&amp; !p.isSneaking() &amp;&amp; h != EnumHand.OFF_HAND) { // Проверка на сервер сторону, что игрок без шифта, что это главная рука.
        CrafterTileEntity te = (CrafterTileEntity) w.getTileEntity(pos); // Получаем тайл
        if (te == null)
            return false;
        ItemStack hand = p.getHeldItem(h).copy(); // Получаем is для возврата итема в руку.
        CrafterRecipe recipe = CrafterRecipe.getRecipe(hand); // Получаем рецепт для предпологаемого рецепта.
        if (recipe == null) // Проверяем, что есть рецепт.
            return false;
        ItemStack put = p.getHeldItem(h).copy(); // Получаем is для тайла.
        hand.shrink(1); // Отнимаем 1 шт.
        put.setCount(1); // Устанавливаем 1 шт.
        te.setInventorySlotContents(0, put); // Помещаем в тайл.
        p.setHeldItem(h, hand); // Устанавливаем возвращенный is.
    }
    return true;
}
</code></pre>
<p>Далее - тайл. Сам тайл был копией печки, но с поправкой - убраны времена, переплавка, изменен update. Его и рассмотрим.</p>
<pre><code class="java language-java">// CrafterTileEntity.java

@Override
public void update() {
    if (getWorld().isRemote) // Если клиент - то нечего.
        return;
    CrafterRecipe recipe = CrafterRecipe.getRecipe(getStackInSlot(0));
    if (recipe == null) { // Если рецепта нету - выбрасываем итем.
        dropItem(getStackInSlot(0));
        return;
    }
    decrStackSize(0, 1); // Если рецепт есть - изымаем из тайла 1 предмет. Хотя, можно установить просто EMPTY в слот.
    dropItem(recipe.getOutput()); // и выбрасываем выходной предмет.
}

private void dropItem(ItemStack is) { // Мини метод для дропа блока.
    getWorld().spawnEntity(new EntityItem(getWorld(), getPos().getX() + 0.5D, getPos().getY() + 0.5D, getPos().getZ() + 0.5D, is));t
}
</code></pre>
<p>Дальше собственно идет поддержка, ибо с блоком мы закончили.
Рассмотрим класс, который добавляет рецепт.</p>
<pre><code class="java language-java">// CrafterRecipeWrapper.java

package xzchtoeto.jei.crafter;

import mezz.jei.api.ingredients.IIngredients;
import mezz.jei.api.recipe.IRecipeWrapper;
import net.minecraft.item.ItemStack;
import xzchtoeto.crafter.CrafterRecipe;

public class CrafterRecipeWrapper implements IRecipeWrapper {

    private ItemStack input; // Объявление входного предмета для рецепта.
    private ItemStack output; // Объявление выходного листа для рецепта.

    public CrafterRecipeWrapper(CrafterRecipe recipe) { // Сам рецепт. Так же можно передавать сюда свои рецепты и разбирать его на входные/выходные предметы.
        input = recipe.getInput(); // Собственно сам входной предмет.
        output = recipe.getOutput(); // Собственно сам выходной предмет.
    }

    @Override
    public void getIngredients(IIngredients ingredients) { // Ингридиенты рецепта.
        ingredients.setInput(ItemStack.class, input); // Входные ингридиенты.
        ingredients.setOutput(ItemStack.class, output); // Выходные ингридиенты.
    }

    public ItemStack getInput() {
        return input;
    }

    public ItemStack getOutput() {
        return output;
    }
}
</code></pre>
<p>Рассмотрим класс, который добавляет ту самую категорию, которая будет видна в JEI.</p>
<pre><code class="java language-java">// CrafterRecipeCategory.java

package xzchtoeto.jei.crafter;

import mezz.jei.api.IGuiHelper;
import mezz.jei.api.gui.IDrawable;
import mezz.jei.api.gui.IDrawableStatic;
import mezz.jei.api.gui.IGuiItemStackGroup;
import mezz.jei.api.gui.IRecipeLayout;
import mezz.jei.api.ingredients.IIngredients;
import mezz.jei.api.recipe.IRecipeCategory;
import net.minecraft.client.Minecraft;
import net.minecraft.util.ResourceLocation;
import xzchtoeto.TestMod;

public class CrafterRecipeCategory implements IRecipeCategory&lt;CrafterRecipeWrapper&gt; {

    public static final String UID = TestMod.MODID + ":crafter"; // Сам UID рецепт.

    private final IDrawableStatic bg; // "Background"

    public CrafterRecipeCategory(IGuiHelper h) {
        bg = h.createDrawable(new ResourceLocation(TestMod.MODID, "textures/gui/jei_crafter.png"), 0, 0, 100, 34); // Объявление background'а.
    }

    @Override
    public String getUid() { // UID рецепта.
        return UID;
    }

    @Override
    public String getTitle() { // Название вкладки в MC, можно использовать I18n переводчик.
        return "Crafter";
    }

    @Override
    public String getModName() { // Название мода.
        return TestMod.MODNAME;
    }

    @Override
    public IDrawable getBackground() {
        return bg;
    }

    @Override
    public void drawExtras(Minecraft mc) { // Любые надписи, которые будут на каждом рецепте.
        // Все координаты идут относительно самого рецепта. Все width и height рассчитывать не нужно.
//        mc.fontRenderer.drawString("Block drops:", 5, 13, 0xffffffff, true);
    }

    @Override
    public void setRecipe(IRecipeLayout layout, CrafterRecipeWrapper recipes, IIngredients ingredients) {

        IGuiItemStackGroup isg = layout.getItemStacks(); // Группа ItemStack, которая нужна для рендера.
        // Все координаты идут относительно самого рецепта. Все width и height рассчитывать не нужно.
        isg.init(0, true, 8, 8); // Инициализируем слот 0. true/false - это обозначение того, является ли слот *ВХОДНЫМ*, true - да, false - нет. Остальные 2 числа - координаты. X/Y.
        isg.set(0, recipes.getInput()); // Добавляем в слот 0 входной предмет.

        isg.init(1, false, 74, 8); // Инициализируем слот 1.  true/false - это обозначение того, является ли слот *ВХОДНЫМ*, true - да, false - нет. Остальные 2 числа - координаты. X/Y.
        isg.set(1, recipes.getOutput()); // Добавляем в слот 1 выходной предмет.
    }
}
</code></pre>
<p>И наконец, добавляем его в регистрацию.
В Ваш плагин в метод registerCategories добавляем:</p>
<pre><code class="java language-java">registry.addRecipeCategories(new CrafterRecipeCategory(registry.getJeiHelpers().getGuiHelper()));
</code></pre>
<p>И в метод register добавляем:</p>
<pre><code class="java language-java">registry.addRecipes(CrafterRecipe.getRecipes(), CrafterRecipeCategory.UID); // Регистрация рецептов для Вашего UID.
registry.handleRecipes(CrafterRecipe.class, recipe -&gt; new CrafterRecipeWrapper(recipe), CrafterRecipeCategory.UID); // Регистрация рецептов из листа рецептов.
registry.addRecipeCatalyst(new ItemStack(TMRegistry.blockCrafter), CrafterRecipeCategory.UID); // Регистрация показывающихся блоков для Вашего UID.
</code></pre>
<p>В итоге получаем такую картину:
<img src="images/crafter_demonstration.png" alt="Демонстрация работы механизма в JEI" /></p>
<p>На этом все. Спасибо за внимание.</p>
<p>P.S. Данная поддержка работает только с теми вещами, что укажите именно Вы. Ничего более она добавлять не будет. С большой вероятностью, Ваш код поддержки не затронет другие моды, т.к. это сделать можно, но если делать качественно - все будет куда лучше.</p>

    </div>

    <section class="next-previous-articles">

        <a class="previous-article" title="Переход на предыдущую статью" href="http:&#x2F;&#x2F;mcmodding.ru&#x2F;book&#x2F;1.12+&#x2F;forge&#x2F;other&#x2F;sources">
            <svg xmlns="http://www.w3.org/2000/svg" width="32" heigth="32" viewBox="0 0 512 512" class="previous-icon">
                <path d="M16 256l240 240v-144h256v-192h-256v-144z"></path>
            </svg>
            <span class="label">Предыдущая статья</span>
        </a>

        <div class="sep"></div>

        <a class="next-article" title="Переход на следующую статью" href="http:&#x2F;&#x2F;mcmodding.ru&#x2F;book&#x2F;1.12+&#x2F;forge&#x2F;other&#x2F;access_transformers">
            <span class="label">Следующая статья</span>
            <svg xmlns="http://www.w3.org/2000/svg" width="32" heigth="32" viewBox="0 0 512 512" class="next-icon">
                <path d="M496 256l-240-240v144h-256v192h256v144z"></path>
            </svg>
        </a>

    </section>

    <section class="contributors">


            <a href="https://github.com/CMTV" target="_blank" title="К профилю GitHub" class="contributor">

                <img class="avatar" src="https://github.com/CMTV.png?size=40">

                <div class="info">

                    <div class="name">CMTV</div>

                    <div class="role">Перенес с форума</div>

                </div>

            </a>


    </section>

    <section class="ad-after-article">

        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <!-- McModding Book Под статьей -->
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-client="ca-pub-8094912170389944"
             data-ad-slot="4828749197"
             data-ad-format="auto"></ins>
        <script>
            (adsbygoogle = window.adsbygoogle || []).push({});
        </script>

    </section>

    <section class="disqus">

        <div id="disqus_thread"></div>
        <script>

            var disqus_config = function () {
                this.page.identifier = 'http://mcmodding.ru/book/1.12+/forge/other/jei_integration';
            };

            (function() { // DON'T EDIT BELOW THIS LINE
                var d = document, s = d.createElement('script');
                s.src = 'https://mcmodding.disqus.com/embed.js';
                s.setAttribute('data-timestamp', +new Date());
                (d.head || d.body).appendChild(s);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

    </section>

    <div class="site-info">

        <a href="https://github.com/mc-modding/mc-modding-book/commits/master" target="_blank" class="copyright">mcmodding.ru</a>

        <a class="version-link" title="Последние изменения" href="https://github.com/mc-modding/mc-modding-book/commits/master" target="_blank">v1.1.1</a>

    </div>

</article>
<!-- Yandex.Metrika counter -->
<script type="text/javascript">
    (function (d, w, c) {
        (w[c] = w[c] || []).push(function() {
            try {
                w.yaCounter21621697 = new Ya.Metrika({
                    id:21621697,
                    clickmap:true,
                    trackLinks:true,
                    accurateTrackBounce:true,
                    webvisor:true
                });
            } catch(e) { }
        });

        var n = d.getElementsByTagName("script")[0],
                s = d.createElement("script"),
                f = function () { n.parentNode.insertBefore(s, n); };
        s.type = "text/javascript";
        s.async = true;
        s.src = "https://mc.yandex.ru/metrika/watch.js";

        if (w.opera == "[object Opera]") {
            d.addEventListener("DOMContentLoaded", f, false);
        } else { f(); }
    })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/21621697" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->

<!-- Google Analytics -->
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-42024721-1', 'auto');
    ga('send', 'pageview');

</script>
<!-- /Google Analytics -->
</body>
</html>